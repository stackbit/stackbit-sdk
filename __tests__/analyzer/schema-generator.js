const { join } = require('path');
const { generateSchema } = require('../../src/analyzer/schema-generator');
const { FileSystemFileBrowserAdapter } = require('../../src/analyzer/file-browser');
const emptyRepoPath = join(__dirname, '../data/empty-repo');
const azimuthRepoPath = join(__dirname, '../data/azimuth');

describe('generate schema', () => {
    test('empty repo', async () => {
        const fileBrowserAdapter = new FileSystemFileBrowserAdapter({ dirPath: emptyRepoPath });
        const schemaGeneratorResult = await generateSchema({ ssgMatchResult: null, fileBrowserAdapter });
        expect(schemaGeneratorResult).toBeNull();
    });

    // todo make it works with autogenerated ids
    test.skip('azimuth', async () => {
        const fileBrowserAdapter = new FileSystemFileBrowserAdapter({ dirPath: azimuthRepoPath });
        const schemaGeneratorResult = await generateSchema({ ssgMatchResult: null, fileBrowserAdapter });
        expect(schemaGeneratorResult).toBe(azimuthGeneratedResult);
    });
});
